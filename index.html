<!doctype html>
<html lang="uk">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>БЕТОН — Де в Києві найкраще купити житло</title>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>

<!-- Turf (для point-in-polygon) -->
<script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>

<style>
  :root{
    /* --accent використовується для заголовків (зроблено чорним) */
    --accent: #111111;
    --accent-2: #0b6b4f;
    --muted: #6b7280;
    --panel-bg: #fff;
    --glass: rgba(255,255,255,0.92);
    --dark: #000000;
    --light-mid: #dcdfe2;
  }

  html,body{height:100%;margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:#f3f6f8;color:#111}
  /* === Шапка: чорний зверху, світло-сірий в центрі, чорний знизу (вертикальний градієнт) === */
  header{
    background: linear-gradient(180deg, #000 0%, var(--light-mid) 50%, #000 100%);
    color:#fff;
    padding:20px 0; /* трохи ширша смужка */
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
  }
  .brand{max-width:1500px;margin:0 auto;display:flex;align-items:center;gap:12px;padding:0 18px}
  .brand h1{font-size:20px;margin:0;color:#fff}
  .brand p{margin:0;opacity:0.95;font-size:14px;color:#f3f6f8}

  main.container{max-width:1500px;margin:12px auto;padding:12px;display:block}

  .layout{display:grid;grid-template-columns:300px 1fr 380px;gap:14px;align-items:start}
  @media(min-width:1100px){ .layout{grid-template-columns:300px 1.5fr 380px;} }
  @media(max-width:1100px){ .layout{grid-template-columns:1fr} .top3-box{position:static;margin-top:12px} }

  .sidebar{background:var(--panel-bg);border-radius:8px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,0.05)}
  /* заголовки тепер чорні */
  .sidebar h3{margin:4px 0 10px;color:var(--accent)}
  .filter-group{margin-bottom:12px}
  .filter-group label{display:block;font-weight:600;margin-bottom:6px;font-size:13px;color:var(--accent)}
  .checkbox-list{display:flex;flex-direction:column;gap:6px}
  .checkbox-list label{font-size:14px;color:#222}
  .small{font-size:13px;color:var(--muted)}
  .range-row{display:flex;gap:8px;align-items:center}
  input[type="range"]{width:100%}

  /* === Кнопки: чорно-сірий градієнт з чорним по краях і світло-сірим в центрі === */
  .btn{
    display:inline-block;padding:9px 12px;border-radius:8px;border:1px solid #000;background:linear-gradient(180deg,#000 0%, var(--light-mid) 50%, #000 100%);
    color:#111;font-weight:700;cursor:pointer;box-shadow:0 6px 14px rgba(0,0,0,0.08)
  }
  .btn:active{transform:translateY(1px)}
  .btn.secondary{
    display:inline-block;padding:8px 10px;border-radius:8px;border:1px solid #000;background:linear-gradient(180deg,#111 0%, #efefef 50%, #111 100%);
    color:#111;font-weight:600;cursor:pointer;
  }

  .map-card{position:relative;border-radius:8px;overflow:hidden;border:1px solid #e6eaee;background:#fff;box-shadow:0 8px 26px rgba(11,107,79,0.06)}
  #map{width:100%;height:640px;display:block}

  .panel{background:var(--panel-bg);border-radius:8px;padding:12px;box-shadow:0 6px 18px rgba(0,0,0,0.05)}
  .panel h3{margin:6px 0;color:var(--accent)}
  .district-row{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:6px;border:1px solid #f0f0f0;margin-bottom:8px;background:#fff;cursor:pointer}
  .district-row:hover{background:#f8fff9}
  .district-name{font-weight:700}
  .district-meta{font-size:13px;color:var(--muted)}
  .bar{height:8px;border-radius:6px;background:#eee;overflow:hidden;margin-top:6px}
  .bar .fill{height:100%;background:linear-gradient(90deg,var(--accent) 0%, var(--accent-2) 100%);width:50%}

  .stats-table{width:100%;border-collapse:collapse;margin-top:10px}
  .stats-table th, .stats-table td{padding:6px;border-bottom:1px solid #f0f0f0;font-size:13px;text-align:left}
  .stats-table th{background:#fafafa;font-weight:700}

  .top3-box{position:fixed;right:18px;bottom:18px;z-index:999;min-width:240px;background:var(--glass);backdrop-filter:blur(6px);border-radius:10px;padding:10px;border:1px solid rgba(0,0,0,0.06);box-shadow:0 10px 30px rgba(0,0,0,0.08)}
  .top3-box h4{margin:0 0 6px;font-size:15px;color:var(--accent)}
  .top3-item{display:flex;justify-content:space-between;align-items:center;padding:6px;border-radius:6px;cursor:pointer}
  .top3-item:hover{background:#fff}
  .file-input{display:flex;gap:8px;flex-direction:column}
  .status{font-size:13px;color:var(--muted);margin-top:8px}
  footer{max-width:1200px;margin:18px auto;padding:12px;color:#666;font-size:13px;text-align:center}

/* === Toggle (зменшена ~0.75) - залишив поведінку та позицію === */
  .map-toggle {
    position: absolute;
    top: 56px;
    right: 12px;
    z-index: 1200;
    width: 69px;
    height: 32px;
    border-radius: 20px;
    background: #e6e6e6;
    display: flex;
    align-items: center;
    padding: 4px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.12);
    cursor: pointer;
    transition: background-color .25s ease, box-shadow .2s ease;
    border: 1px solid rgba(0,0,0,0.06);
  }
  .map-toggle.on { background: #eaffec; }
  .map-toggle.off { background: #f0f0f0; }

  .map-toggle .knob {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: #9be6a3;
    box-shadow: 0 6px 14px rgba(0,0,0,0.18);
    transition: transform .25s cubic-bezier(.2,.9,.2,1), background-color .25s ease;
    transform: translateX(0);
  }
  .map-toggle.on .knob { transform: translateX(34px); background: #9be6a3; }
  .map-toggle.off .knob { transform: translateX(0); background: #bdbdbd; }

/* Leaflet control container position */
  .map-card .leaflet-control-layers { position:absolute; top:12px; right:12px; z-index:1199; background:#fff; border-radius:8px; padding:6px; box-shadow:0 8px 20px rgba(0,0,0,0.12); }

/* ====== RANGE (повзунки) ====== */
  input[type="range"]{
    -webkit-appearance: none;
    appearance: none;
    height: 8px;
    background: #e6e6e6; /* світлосірий трек */
    border-radius: 999px;
    outline: none;
  }
  /* Webkit track */
  input[type="range"]::-webkit-slider-runnable-track{
    height:8px;
    background:#e6e6e6;
    border-radius:999px;
  }
  input[type="range"]::-webkit-slider-thumb{
    -webkit-appearance: none;
    appearance: none;
    margin-top:-8px; /* center thumb relative to track */
    width:18px;
    height:18px;
    border-radius:50%;
    background:#9e9e9e; /* чуть темніший кружочок */
    box-shadow: 0 2px 6px rgba(0,0,0,0.18);
    border:2px solid #f3f3f3;
    cursor:pointer;
  }
  /* Firefox */
  input[type="range"]::-moz-range-track{
    height:8px;
    background:#e6e6e6;
    border-radius:999px;
  }
  input[type="range"]::-moz-range-thumb{
    width:18px;
    height:18px;
    border-radius:50%;
    background:#9e9e9e;
    border:2px solid #f3f3f3;
    box-shadow: 0 2px 6px rgba(0,0,0,0.18);
    cursor:pointer;
  }
</style>
</head>
<body>

<header>
  <div class="brand">
    <h1>БЕТОН</h1>
    <p>Інтерактивна мапа: де в Києві найкраще купити житло — критерії, рейтинги, статистика</p>
  </div>
</header>

<main class="container">
  <div class="layout">

    <!-- LEFT -->
    <aside class="sidebar" id="filters">
      <h3>Фільтри та файли</h3>

      <div class="filter-group">
        <label for="filter_type">Тип житла</label>
        <select id="filter_type" style="width:100%;padding:8px;border-radius:8px;border:1px solid #e6eaee">
          <option value="">Будь-який</option>
          <option value="apartment">Квартира</option>
          <option value="studio">Студія</option>
          <option value="house">Будинок</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="filter_price">Ціна (макс), грн/м²</label>
        <div class="range-row">
          <input id="filter_price" type="number" placeholder="Наприклад 40000" style="padding:8px;border-radius:8px;border:1px solid #e6eaee;width:120px" />
          <button class="btn secondary" id="price_reset" type="button">Скинути</button>
        </div>
        <div class="small" style="margin-top:6px">Вкажи ліміт ціни на квадратний метр</div>
      </div>

      <div class="filter-group">
        <label>Інфраструктура (відмітьте потрібне)</label>
        <div class="checkbox-list" id="criteriaList">
          <label><input id="crit_schools" type="checkbox" class="crit" data-crit="schools" /> Школи, ліцеї</label>
          <label><input id="crit_kindergartens" type="checkbox" class="crit" data-crit="kindergartens" /> Дитсадки</label>
          <label><input id="crit_universities" type="checkbox" class="crit" data-crit="universities" /> Університети</label>
          <label><input id="crit_metro" type="checkbox" class="crit" data-crit="metro" /> Метро / вокзали</label>
          <label><input id="crit_parks" type="checkbox" class="crit" data-crit="parks" /> Парки та зони відпочинку</label>
          <label><input id="crit_dog" type="checkbox" class="crit" data-crit="dogparks" /> Місця для вигулу собак</label>
          <label><input id="crit_health" type="checkbox" class="crit" data-crit="health" /> Лікарні та аптеки</label>
          <label><input id="crit_offices" type="checkbox" class="crit" data-crit="offices" /> Офіси / робочі місця</label>
          <label><input id="crit_supermarkets" type="checkbox" class="crit" data-crit="supermarkets" /> Супермаркети / магазини</label>
          <label><input id="crit_parking" type="checkbox" class="crit" data-crit="parking" /> Парковки, стоянки</label>
          <label><input id="crit_bus" type="checkbox" class="crit" data-crit="bus" /> Автобусні зупинки / станції</label>
        </div>
      </div>

      <div class="filter-group">
        <label>Вага критеріїв</label>
        <div class="small">Транспорт</div><input id="w_transport" type="range" min="0" max="100" value="50" />
        <div class="small">Інфраструктура</div><input id="w_infra" type="range" min="0" max="100" value="50" />
        <div class="small">Безпека</div><input id="w_safety" type="range" min="0" max="100" value="50" />
        <div class="small">Шум (мінімізувати)</div><input id="w_noise" type="range" min="0" max="100" value="50" />
      </div>

      <div style="display:flex;gap:8px;justify-content:space-between;margin-top:8px">
        <button class="btn" id="applyFilters" type="button">Показати результати</button>
        <button class="btn secondary" id="resetFilters" type="button">Скинути</button>
      </div>

      <hr style="margin:12px 0" />

      <h3 style="margin-bottom:8px">Завантажити GeoJSON районів</h3>
      <div class="file-input">
        <label class="small">districts GeoJSON (ADM2) — файл: <code>assets/kyiv_districts.geojson</code></label>
        <input id="fileDistricts" type="file" accept=".geojson,.json" />
        <button class="btn" id="btnLoadDistrict" type="button">Load districts</button>
        <div class="status" id="fileStatus">Файл точок підвантажується з <code>assets/points.geojson</code> або з GitHub raw (якщо файл не локально).</div>
      </div>
    </aside>

    <!-- CENTER: MAP -->
    <section>
      <div class="map-card">
        <div id="map" aria-label="Карта районів Києва"></div>

        <!-- STATIC TOGGLE -->
        <div id="markerToggle" class="map-toggle on" title="Показ/сховати всі маркери">
          <div class="knob"></div>
        </div>
        <!-- Leaflet layer control буде переміщений сюди скриптом -->
      </div>

      <div style="margin-top:12px;background:#fff;padding:12px;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.04)">
        <h3 style="margin:0 0 8px;color:var(--accent)">Таблиця статистики по районам</h3>
        <div style="overflow:auto">
          <table class="stats-table" id="statsTable" style="width:100%">
            <thead>
              <tr><th>Район</th><th>Населення</th><th>Шкіл</th><th>Садків</th><th>Метро</th><th>Робочих місць</th><th>Середня ціна, грн/м²</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- RIGHT -->
    <aside class="panel" id="rightPanel">
      <h3>Райони (в порядку релевантності)</h3>
      <div id="districtList"></div>
      <hr style="margin:12px 0" />
      <div>
        <h4 style="margin:0 0 6px">Пояснення рейтингу</h4>
        <div class="small">Рейтинг розраховується за вагами ліворуч. Шум враховується негативно.</div>
      </div>
    </aside>

  </div>
</main>

<!-- FLOATING TOP-3 -->
<div class="top3-box" id="top3Box" aria-live="polite">
  <h4>ТОП-3 районів</h4>
  <div id="top3List">
    <div class="top3-item">1. —</div>
    <div class="top3-item">2. —</div>
    <div class="top3-item">3. —</div>
  </div>
</div>

<footer>© <span id="year"></span> БЕТОН — демо.</footer>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

<script>
/* --- JS логіка (залишив без змін, як у попередній версії) --- */
/* Якщо потрібні правки в JS — скажи, підправлю. */
/* (Тут має бути ваш існуючий JS зі всіма функціями завантаження geojson, рендеру і т.д.) */

document.addEventListener('DOMContentLoaded', () => {
  // цей блок — спрощений шорткат: підключи свій попередній JS код сюди (вставлено нижче лише базову ініціалізацію)
  // Якщо хочеш, я підключу повний останній JS зі всіх попередніх змін (залишив поза цим фрагментом, щоб код не дублювався у відповіді).
  console.log('UI styles оновлені: градієнти, кнопки, повзунки.');
  document.getElementById('year').textContent = new Date().getFullYear();
});
</script>
</body>
</html>
